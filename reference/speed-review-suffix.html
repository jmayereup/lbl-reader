<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suffix Speed Run: Noun Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Scoped styles for the game container */
        .speed-review-container {
            font-family: 'Inter', sans-serif;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-option {
            transition: all 0.3s ease;
        }
        .btn-option:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .correct {
            background-color: #22c55e !important; /* Tailwind green-500 */
            color: white !important;
            border-color: #16a34a !important; /* green-600 */
        }
        .incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            color: white !important;
            border-color: #dc2626 !important; /* red-600 */
        }
        #timer-bar-inner {
            transition: width 0.1s linear;
        }
    </style>
</head>
<body>

    <div class="speed-review-container bg-gradient-to-br from-indigo-900 to-slate-800 text-white min-h-screen flex items-center justify-center p-4">
        <div id="game-container" class="w-full max-w-2xl mx-auto">
            <!-- Main Game Card -->
            <div class="card rounded-2xl p-6 md:p-8 shadow-2xl">
                <header class="flex justify-between items-start mb-4">
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-slate-200">Suffix Speed Run üèÉ</h1>
                         <div class="text-left mt-2">
                            <p class="text-slate-400 text-xs">Best Score</p>
                            <p id="best-score" class="text-lg font-bold">0</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-slate-400 text-sm">Score</p>
                        <p id="score" class="text-2xl font-bold">0</p>
                    </div>
                </header>
                
                <div class="flex justify-between items-center mb-6 text-slate-400">
                    <p id="question-counter" class="text-sm font-semibold"></p>
                    <div id="timer-bar" class="w-1/2 h-2 bg-slate-700 rounded-full overflow-hidden">
                        <div id="timer-bar-inner" class="h-full bg-cyan-400 rounded-full"></div>
                    </div>
                </div>
    
    
                <main id="question-area">
                    <div id="category-display" class="mb-2 text-sm font-semibold text-cyan-400 uppercase tracking-wider"></div>
                    <p id="question-text" class="text-xl md:text-2xl text-slate-200 leading-relaxed mb-8 min-h-[100px]"></p>
                    <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Options will be injected here by JavaScript -->
                    </div>
                </main>
    
                <footer id="feedback-area" class="mt-8 min-h-[110px] text-center">
                    <div id="feedback-icon" class="h-8 mb-2"></div>
                    <p id="feedback-text" class="text-lg text-slate-300"></p>
                    <button id="next-btn" class="hidden w-full mt-4 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition-colors text-center">Next Question</button>
                </footer>
            </div>
            
            <!-- End Screen Card -->
            <div id="end-screen" class="hidden text-center card rounded-2xl p-8 shadow-2xl">
                 <h2 class="text-4xl font-bold mb-2">Quiz Complete!</h2>
                 <p id="congrats-message" class="text-lg text-yellow-300 font-semibold mb-2 hidden"></p>
                 <p class="text-xl text-slate-300 mb-2">Your final score is:</p>
                 <p id="final-score" class="text-6xl font-extrabold text-cyan-400 mb-8">0</p>
                 <button id="restart-btn" class="w-full max-w-sm mx-auto bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-4 px-6 rounded-lg transition-colors text-lg text-center">Play Again</button>
            </div>
    
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const scoreEl = document.getElementById('score');
        const bestScoreEl = document.getElementById('best-score');
        const categoryDisplayEl = document.getElementById('category-display');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainerEl = document.getElementById('options-container');
        const feedbackIconEl = document.getElementById('feedback-icon');
        const feedbackTextEl = document.getElementById('feedback-text');
        const nextBtn = document.getElementById('next-btn');
        const gameContainer = document.getElementById('game-container');
        const endScreen = document.getElementById('end-screen');
        const finalScoreEl = document.getElementById('final-score');
        const restartBtn = document.getElementById('restart-btn');
        const questionCounterEl = document.getElementById('question-counter');
        const timerBarInnerEl = document.getElementById('timer-bar-inner');
        const congratsMessageEl = document.getElementById('congrats-message');

        // --- Sound Synthesis using Tone.js ---
        const synthCorrect = new Tone.Synth().toDestination();
        const synthIncorrect = new Tone.Synth({ oscillator: { type: "square" } }).toDestination();

        // --- Game Data (based on the provided image) ---
        const questions = [
            // Table 1: Verb -> Noun
            { category: "Verb ‚Üí Noun", question: "The act of defining a word is its ____.", options: ["definition", "definement", "wisdom", "arrival"], answer: "definition", explanation: "To turn the verb <strong>define</strong> into a noun, we add the suffix <strong>-tion</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "Please provide a ____ of the stolen item.", options: ["description", "describement", "freedom", "artist"], answer: "description", explanation: "The noun form of the verb <strong>describe</strong> is 'description', using the suffix <strong>-tion</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The teacher's ____ of the student's work was positive.", options: ["evaluation", "evaluatement", "conclusion", "mileage"], answer: "evaluation", explanation: "The noun form of the verb <strong>evaluate</strong> is 'evaluation', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "His ____ for being late wasn't very believable.", options: ["explanation", "explainment", "justice", "reliance"], answer: "explanation", explanation: "The noun form of the verb <strong>explain</strong> is 'explanation', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "A good author has a vivid ____.", options: ["imagination", "imaginehood", "bravery", "membership"], answer: "imagination", explanation: "The noun form of the verb <strong>imagine</strong> is 'imagination', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The police started an ____ into the crime.", options: ["investigation", "investigament", "sadness", "actor"], answer: "investigation", explanation: "The noun form of the verb <strong>investigate</strong> is 'investigation', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "We need your ____ in this important project.", options: ["participation", "participatement", "handful", "silence"], answer: "participation", explanation: "The noun form of the verb <strong>participate</strong> is 'participation', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The sudden ____ of the truth shocked her.", options: ["realization", "realizement", "neighborhood", "possibility"], answer: "realization", explanation: "The noun form of the verb <strong>realize</strong> is 'realization', using the suffix <strong>-ation</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "At the ____ of the story, the hero wins.", options: ["conclusion", "concludement", "reality", "friendship"], answer: "conclusion", explanation: "The noun form of the verb <strong>conclude</strong> is 'conclusion', using the suffix <strong>-sion</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "To make a ____ is to decide something.", options: ["decision", "decidement", "investment", "loneliness"], answer: "decision", explanation: "The noun form of the verb <strong>decide</strong> is 'decision', using the suffix <strong>-sion</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "A person who acts in a movie is called an ____.", options: ["actor", "actment", "employer", "childhood"], answer: "actor", explanation: "To describe a person who performs the verb <strong>act</strong>, we add the suffix <strong>-or</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The person who hires you is your ____.", options: ["employer", "employment", "resident", "baggage"], answer: "employer", explanation: "A person who performs the verb <strong>employ</strong> is an 'employer', using the suffix <strong>-er</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "Graduating from college is a great ____.", options: ["accomplishment", "accomplishness", "inquiry", "happiness"], answer: "accomplishment", explanation: "The noun form of the verb <strong>accomplish</strong> is 'accomplishment', using the suffix <strong>-ment</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "When you achieve a goal, you have an ____.", options: ["achievement", "achievation", "dependence", "similarity"], answer: "achievement", explanation: "The noun form of the verb <strong>achieve</strong> is 'achievement', using the suffix <strong>-ment</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The two sides finally reached an ____.", options: ["agreement", "agreeance", "discovery", "validity"], answer: "agreement", explanation: "The noun form of the verb <strong>agree</strong> is 'agreement', using the suffix <strong>-ment</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "He felt a great sense of ____ from his work.", options: ["fulfillment", "fulfillness", "denial", "urgency"], answer: "fulfillment", explanation: "The noun form of the verb <strong>fulfill</strong> is 'fulfillment', using the suffix <strong>-ment</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "Buying a house is a very large ____.", options: ["investment", "investion", "assistance", "terrorism"], answer: "investment", explanation: "The noun form of the verb <strong>invest</strong> is 'investment', using the suffix <strong>-ment</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The ____ of the team bus was delayed by traffic.", options: ["arrival", "arrivement", "mouthful", "importance"], answer: "arrival", explanation: "The noun form of the verb <strong>arrive</strong> is 'arrival', using the suffix <strong>-al</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The suspect's ____ of the crime was not convincing.", options: ["denial", "denyhood", "complexity", "realization"], answer: "denial", explanation: "The noun form of the verb <strong>deny</strong> is 'denial', using the suffix <strong>-al</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "Someone who assists you is an ____.", options: ["assistant", "assisting", "artist", "childhood"], answer: "assistant", explanation: "A person who performs the verb <strong>assist</strong> is an 'assistant', using the suffix <strong>-ant</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "A person living in a place is a ____.", options: ["resident", "residence", "actor", "membership"], answer: "resident", explanation: "A person who performs the verb <strong>reside</strong> is a 'resident', using the suffix <strong>-ent</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "We appreciate your ____ with this matter.", options: ["assistance", "assistment", "friendship", "decision"], answer: "assistance", explanation: "The noun form of the verb <strong>assist</strong> is 'assistance', using the suffix <strong>-ance</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "Your ____ on your parents is normal when you are young.", options: ["dependence", "dependance", "achievement", "evaluation"], answer: "dependence", explanation: "The noun form of the verb <strong>depend</strong> is 'dependence', using the suffix <strong>-ence</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The company's ____ on a single product is risky.", options: ["reliance", "relyment", "explanation", "justice"], answer: "reliance", explanation: "The noun form of the verb <strong>rely</strong> is 'reliance', using the suffix <strong>-ance</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The ____ of a new island was a big event.", options: ["discovery", "discoverance", "description", "sadness"], answer: "discovery", explanation: "The noun form of the verb <strong>discover</strong> is 'discovery', using the suffix <strong>-ry</strong>. The other words don't fit the sentence's meaning." },
            { category: "Verb ‚Üí Noun", question: "The journalist made an ____ about the new policy.", options: ["inquiry", "inquireness", "imagination", "freedom"], answer: "inquiry", explanation: "The noun form of the verb <strong>inquire</strong> is 'inquiry', using the suffix <strong>-ry</strong>. The other words don't fit the sentence's meaning." },

            // Table 2: Adjective -> Noun
            { category: "Adjective ‚Üí Noun", question: "The ____ of the problem was surprising.", options: ["complexity", "complexness", "arrival", "wisdom"], answer: "complexity", explanation: "The noun form of the adjective <strong>complex</strong> is 'complexity', using the suffix <strong>-ity</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "It is a ____ that you can come to the party.", options: ["possibility", "possibleness", "investment", "silence"], answer: "possibility", explanation: "The noun form of the adjective <strong>possible</strong> is 'possibility', using the suffix <strong>-ity</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "Sometimes, ____ is stranger than fiction.", options: ["reality", "realness", "membership", "inquiry"], answer: "reality", explanation: "The noun form of the adjective <strong>real</strong> is 'reality', using the suffix <strong>-ity</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "There is a strong ____ between the two brothers.", options: ["similarity", "similarism", "accomplishment", "childhood"], answer: "similarity", explanation: "The noun form of the adjective <strong>similar</strong> is 'similarity', using the suffix <strong>-ity</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "You must check the ____ of your ticket.", options: ["validity", "validness", "dependence", "agreement"], answer: "validity", explanation: "The noun form of the adjective <strong>valid</strong> is 'validity', using the suffix <strong>-ity</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "Her greatest wish was for her family's ____.", options: ["happiness", "happyment", "denial", "resident"], answer: "happiness", explanation: "To turn the adjective <strong>happy</strong> into a noun, we add the suffix <strong>-ness</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "He suffered from great ____ in the big city.", options: ["loneliness", "lonelyhood", "assistance", "bravery"], answer: "loneliness", explanation: "The noun form of the adjective <strong>lonely</strong> is 'loneliness', using the suffix <strong>-ness</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "Her face was filled with ____ when her dog died.", options: ["sadness", "sadity", "discovery", "employer"], answer: "sadness", explanation: "The noun form of the adjective <strong>sad</strong> is 'sadness', using the suffix <strong>-ness</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "The statue represents ____ and justice.", options: ["freedom", "freement", "fulfillment", "investigation"], answer: "freedom", explanation: "The noun form of the adjective <strong>free</strong> is 'freedom', using the suffix <strong>-dom</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "The old man was known for his great ____.", options: ["wisdom", "wiseness", "conclusion", "participation"], answer: "wisdom", explanation: "The noun form of the adjective <strong>wise</strong> is 'wisdom', using the suffix <strong>-dom</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "He felt a sense of ____ to finish the report.", options: ["urgency", "urgentment", "reliance", "definition"], answer: "urgency", explanation: "The noun form of the adjective <strong>urgent</strong> is 'urgency', using the suffix <strong>-cy</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "She stressed the ____ of hard work.", options: ["importance", "importantness", "terrorism", "evaluation"], answer: "importance", explanation: "The noun form of the adjective <strong>important</strong> is 'importance', using the suffix <strong>-ce</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "The library was filled with complete ____.", options: ["silence", "silentness", "artist", "mileage"], answer: "silence", explanation: "The noun form of the adjective <strong>silent</strong> is 'silence', using the suffix <strong>-ence</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "The judge is a symbol of ____.", options: ["justice", "justness", "handful", "explanation"], answer: "justice", explanation: "The noun form of the adjective <strong>just</strong> is 'justice', using the suffix <strong>-ice</strong>. The other words don't fit the sentence's meaning." },
            { category: "Adjective ‚Üí Noun", question: "She showed great ____ in the face of danger.", options: ["bravery", "braveness", "neighborhood", "possibility"], answer: "bravery", explanation: "The noun form of the adjective <strong>brave</strong> is 'bravery', using the suffix <strong>-ery</strong> (related to -ry). The other words don't fit the sentence's meaning." },

            // Table 3: Noun -> Noun
            { category: "Noun ‚Üí Noun", question: "Acts of ____ are not tolerated.", options: ["terrorism", "terrorhood", "validity", "loneliness"], answer: "terrorism", explanation: "The noun is <strong>terrorism</strong>, using the suffix <strong>-ism</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "The ____ between the two countries is strong.", options: ["friendship", "friendhood", "complexity", "decision"], answer: "friendship", explanation: "The relationship between friends is called <strong>friendship</strong>, using the suffix <strong>-ship</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "You need to renew your gym ____.", options: ["membership", "memberhood", "similarity", "achievement"], answer: "membership", explanation: "The noun form of <strong>member</strong> is 'membership', using the suffix <strong>-ship</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "All of our ____ is at the airport check-in.", options: ["baggage", "bagship", "reality", "agreement"], answer: "baggage", explanation: "The noun form is <strong>baggage</strong>, using the suffix <strong>-age</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "What is the ____ on your new car?", options: ["mileage", "mileship", "happiness", "actor"], answer: "mileage", explanation: "The noun form of <strong>mile</strong> is 'mileage', using the suffix <strong>-age</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "The state of being a child is called ____.", options: ["childhood", "childship", "wisdom", "arrival"], answer: "childhood", explanation: "We add the suffix <strong>-hood</strong> to the noun <strong>child</strong> to get 'childhood'. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "We live in a very friendly ____.", options: ["neighborhood", "neighborism", "justice", "discovery"], answer: "neighborhood", explanation: "The noun form of <strong>neighbor</strong> is 'neighborhood', using the suffix <strong>-hood</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "A person who creates paintings is an ____.", options: ["artist", "artship", "urgency", "reliance"], answer: "artist", explanation: "A person skilled at an <strong>art</strong> is an 'artist', using the suffix <strong>-ist</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "Please take a ____ of nuts.", options: ["handful", "handage", "importance", "fulfillment"], answer: "handful", explanation: "The amount a <strong>hand</strong> can hold is a 'handful', using the suffix <strong>-ful</strong>. The other words don't fit the sentence's meaning." },
            { category: "Noun ‚Üí Noun", question: "Just eat a ____ of rice, not the whole bowl.", options: ["mouthful", "mouthship", "silence", "description"], answer: "mouthful", explanation: "The amount a <strong>mouth</strong> can hold is a 'mouthful', using the suffix <strong>-ful</strong>. The other words don't fit the sentence's meaning." }
        ];

        // --- Game State & Constants ---
        const TIME_LIMIT = 15; // Time per question in seconds
        const TOTAL_QUESTIONS = 10; // Number of questions per game (randomly selected from the pool above)
        let score = 0;
        let bestScore = 0;
        let currentQuestionIndex = 0;
        let availableQuestions = [];
        let timerInterval;
        let timeLeft;

        // --- Main Functions ---

        /**
         * Plays a sound for a correct answer.
         * Requires user interaction to start audio context in the browser.
         */
        function playCorrectSound() {
            if (typeof Tone !== 'undefined') {
                Tone.start(); 
                synthCorrect.triggerAttackRelease("C5", "8n");
            }
        }

        /**
         * Plays a sound for an incorrect answer.
         */
        function playIncorrectSound() {
             if (typeof Tone !== 'undefined') {
                Tone.start();
                synthIncorrect.triggerAttackRelease("G2", "8n");
            }
        }

        /**
         * Initializes or restarts the game.
         */
        function startGame() {
            score = 0;
            currentQuestionIndex = 0;
            availableQuestions = [...questions];
            shuffleArray(availableQuestions);
            
            // Load best score from browser's local storage
            bestScore = localStorage.getItem('suffixBestScore') || 0;
            bestScoreEl.textContent = bestScore;

            scoreEl.textContent = score;
            endScreen.classList.add('hidden');
            congratsMessageEl.classList.add('hidden');
            gameContainer.querySelector('.card').classList.remove('hidden');
            loadQuestion();
        }

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         * @param {Array} array The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        /**
         * Starts the countdown timer for the current question.
         */
        function startTimer() {
            timeLeft = TIME_LIMIT;
            clearInterval(timerInterval);
            timerBarInnerEl.style.width = '100%';
            timerBarInnerEl.style.backgroundColor = '#22d3ee'; // cyan-400

            timerInterval = setInterval(() => {
                timeLeft--;
                const percentage = (timeLeft / TIME_LIMIT) * 100;
                timerBarInnerEl.style.width = `${percentage}%`;

                // Change color when time is low
                if (timeLeft < 5) {
                    timerBarInnerEl.style.backgroundColor = '#f87171'; // red-400
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeUp();
                }
            }, 1000);
        }

        /**
         * Loads the next question or ends the game if all questions are answered.
         */
        function loadQuestion() {
            if (currentQuestionIndex >= TOTAL_QUESTIONS) {
                showEndScreen();
                return;
            }

            // Reset UI elements for the new question
            feedbackTextEl.innerHTML = '';
            feedbackIconEl.innerHTML = '';
            nextBtn.classList.add('hidden');
            questionCounterEl.textContent = `Question ${currentQuestionIndex + 1} / ${TOTAL_QUESTIONS}`;

            const currentQuestion = availableQuestions[currentQuestionIndex];
            categoryDisplayEl.textContent = currentQuestion.category;
            questionTextEl.textContent = currentQuestion.question;
            optionsContainerEl.innerHTML = '';

            // Create a copy to shuffle so the original order isn't changed
            const optionsToShuffle = [...currentQuestion.options];
            shuffleArray(optionsToShuffle);

            // Create and display answer option buttons
            optionsToShuffle.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('btn-option', 'w-full', 'text-center', 'bg-slate-700', 'hover:bg-slate-600', 'text-white', 'font-semibold', 'py-3', 'px-4', 'rounded-lg', 'border-2', 'border-slate-600');
                button.onclick = () => selectAnswer(option, button, currentQuestion);
                optionsContainerEl.appendChild(button);
            });
            
            startTimer();
        }
        
        /**
         * Handles the case where the player runs out of time.
         */
        function handleTimeUp() {
            playIncorrectSound();
            const question = availableQuestions[currentQuestionIndex];
            feedbackIconEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;
            feedbackTextEl.innerHTML = `<span class="font-bold text-red-400">Time's up!</span> The correct answer was '${question.answer}'.`;
            
            const buttons = optionsContainerEl.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === question.answer) {
                    btn.classList.add('correct');
                }
            });

            nextBtn.classList.remove('hidden');
        }

        /**
         * Processes the player's selected answer.
         * @param {string} selectedOption The text of the selected option.
         * @param {HTMLElement} button The button element that was clicked.
         * @param {object} question The current question object.
         */
        function selectAnswer(selectedOption, button, question) {
            clearInterval(timerInterval); // Stop the timer
            
            const buttons = optionsContainerEl.querySelectorAll('button');
            buttons.forEach(btn => btn.disabled = true);

            if (selectedOption === question.answer) {
                // Award points based on time left
                const points = Math.max(10, Math.round(timeLeft * 10)); 
                score += points;
                scoreEl.textContent = score;
                button.classList.add('correct');
                playCorrectSound();
                feedbackIconEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>`;
                feedbackTextEl.innerHTML = `<span class="font-bold text-green-400">+${points} points!</span> ${question.explanation}`;
            } else {
                button.classList.add('incorrect');
                playIncorrectSound();
                feedbackIconEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>`;
                feedbackTextEl.innerHTML = `<span class="font-bold text-red-400">Not quite.</span> ${question.explanation}`;
                // Highlight the correct answer
                buttons.forEach(btn => {
                    if (btn.textContent === question.answer) {
                        btn.classList.add('correct');
                    }
                });
            }
            
            nextBtn.classList.remove('hidden');
        }
        
        /**
         * Moves to the next question.
         */
        function handleNextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        /**
         * Displays the final score screen.
         */
        function showEndScreen() {
            gameContainer.querySelector('.card').classList.add('hidden');
            finalScoreEl.textContent = score;

            // Check for a new high score
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('suffixBestScore', bestScore);
                congratsMessageEl.textContent = "üéâ New High Score! Congratulations! üéâ";
                congratsMessageEl.classList.remove('hidden');
            }

            endScreen.classList.remove('hidden');
        }

        // --- Event Listeners ---
        nextBtn.addEventListener('click', handleNextQuestion);
        restartBtn.addEventListener('click', startGame);

        // --- Initial Load ---
        startGame();
    </script>
</body>
</html>

